[2025-08-18 12:55:52,218] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[INFO|2025-08-18 12:55:55] llamafactory.cli:143 >> Initializing 8 distributed tasks at: 192.168.0.100:29500
[INFO|2025-08-18 12:55:55] llamafactory.cli:143 >> Multi-node training enabled: num nodes: 2, node rank: 0
[2025-08-18 12:56:04,806] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-18 12:56:04,972] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-18 12:56:05,005] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-18 12:56:05,067] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-18 12:56:05,080] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-18 12:56:05,081] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-18 12:56:05,164] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-08-18 12:56:05,169] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[2025-08-18 12:56:06,233] [INFO] [comm.py:669:init_distributed] cdb=None
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[2025-08-18 12:56:06,415] [INFO] [comm.py:669:init_distributed] cdb=None
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[2025-08-18 12:56:06,522] [INFO] [comm.py:669:init_distributed] cdb=None
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[2025-08-18 12:56:06,532] [INFO] [comm.py:669:init_distributed] cdb=None
[2025-08-18 12:56:06,552] [INFO] [comm.py:669:init_distributed] cdb=None
[2025-08-18 12:56:06,601] [INFO] [comm.py:669:init_distributed] cdb=None
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[2025-08-18 12:56:06,677] [INFO] [comm.py:669:init_distributed] cdb=None
[2025-08-18 12:56:06,763] [INFO] [comm.py:669:init_distributed] cdb=None
[2025-08-18 12:56:06,764] [INFO] [comm.py:700:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:143 >> Set `ddp_find_unused_parameters` to False in DDP training since LoRA is enabled.
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:410 >> Process rank: 0, world size: 16, device: cuda:0, distributed training: True, compute dtype: torch.bfloat16
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,243 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,243 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,243 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,243 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,243 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,243 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,243 >> loading file chat_template.jinja
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:410 >> Process rank: 5, world size: 16, device: cuda:5, distributed training: True, compute dtype: torch.bfloat16
[INFO|tokenization_utils_base.py:2336] 2025-08-18 12:56:08,471 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:750] 2025-08-18 12:56:08,471 >> loading configuration file /data/Qwen2.5-32B-Instruct/config.json
[INFO|configuration_utils.py:817] 2025-08-18 12:56:08,473 >> Model config Qwen2Config {
  "architectures": [
    "Qwen2ForCausalLM"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 5120,
  "initializer_range": 0.02,
  "intermediate_size": 27648,
  "layer_types": [
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention"
  ],
  "max_position_embeddings": 32768,
  "max_window_layers": 70,
  "model_type": "qwen2",
  "num_attention_heads": 40,
  "num_hidden_layers": 64,
  "num_key_value_heads": 8,
  "rms_norm_eps": 1e-06,
  "rope_scaling": null,
  "rope_theta": 1000000.0,
  "sliding_window": null,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.55.0",
  "use_cache": true,
  "use_sliding_window": false,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,473 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,473 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,473 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,473 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,473 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,473 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2065] 2025-08-18 12:56:08,473 >> loading file chat_template.jinja
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:410 >> Process rank: 4, world size: 16, device: cuda:4, distributed training: True, compute dtype: torch.bfloat16
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:410 >> Process rank: 6, world size: 16, device: cuda:6, distributed training: True, compute dtype: torch.bfloat16
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:410 >> Process rank: 2, world size: 16, device: cuda:2, distributed training: True, compute dtype: torch.bfloat16
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:410 >> Process rank: 3, world size: 16, device: cuda:3, distributed training: True, compute dtype: torch.bfloat16
[INFO|tokenization_utils_base.py:2336] 2025-08-18 12:56:08,703 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|2025-08-18 12:56:08] llamafactory.data.template:143 >> Replace eos token: <|eot_id|>.
[WARNING|2025-08-18 12:56:08] llamafactory.data.template:148 >> New tokens have been added, make sure `resize_vocab` is True.
[INFO|2025-08-18 12:56:08] llamafactory.data.template:143 >> Add <|eom_id|> to stop words.
[WARNING|2025-08-18 12:56:08] llamafactory.data.template:148 >> New tokens have been added, make sure `resize_vocab` is True.
[INFO|2025-08-18 12:56:08] llamafactory.data.loader:143 >> Loading dataset identity.json...
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:410 >> Process rank: 7, world size: 16, device: cuda:7, distributed training: True, compute dtype: torch.bfloat16
[INFO|2025-08-18 12:56:08] llamafactory.hparams.parser:410 >> Process rank: 1, world size: 16, device: cuda:1, distributed training: True, compute dtype: torch.bfloat16
[rank5]:[W818 12:56:08.289349571 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 5]  using GPU 5 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank4]:[W818 12:56:09.519690497 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 4]  using GPU 4 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank6]:[W818 12:56:09.557511954 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 6]  using GPU 6 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank2]:[W818 12:56:09.607899611 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank3]:[W818 12:56:09.635183494 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank7]:[W818 12:56:09.750934366 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 7]  using GPU 7 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank1]:[W818 12:56:09.954081218 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
Converting format of dataset (num_proc=16):   0% 0/91 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):  84% 76/91 [00:00<00:00, 757.88 examples/s]Converting format of dataset (num_proc=16): 100% 91/91 [00:00<00:00, 503.55 examples/s]
[INFO|2025-08-18 12:56:09] llamafactory.data.loader:143 >> Loading dataset alpaca_en_demo.json...
Converting format of dataset (num_proc=16):   0% 0/999 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):  44% 441/999 [00:00<00:00, 2186.86 examples/s]Converting format of dataset (num_proc=16): 100% 999/999 [00:00<00:00, 3488.16 examples/s]
[rank0]:[W818 12:56:10.258480573 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
907d14e27ed8:2064:2064 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2064:2064 [0] NCCL INFO Bootstrap : Using eth0:192.168.0.100<0>
907d14e27ed8:2064:2064 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
907d14e27ed8:2064:2064 [0] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
907d14e27ed8:2064:2064 [0] NCCL INFO NET/Plugin: Using internal network plugin.
907d14e27ed8:2064:2064 [0] NCCL INFO cudaDriverVersion 12040
NCCL version 2.21.5+cuda12.4
907d14e27ed8:2064:2064 [0] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2067:2067 [3] NCCL INFO cudaDriverVersion 12040
907d14e27ed8:2067:2067 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2067:2067 [3] NCCL INFO Bootstrap : Using eth0:192.168.0.100<0>
907d14e27ed8:2067:2067 [3] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
907d14e27ed8:2067:2067 [3] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
907d14e27ed8:2067:2067 [3] NCCL INFO NET/Plugin: Using internal network plugin.
907d14e27ed8:2067:2067 [3] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2068:2068 [4] NCCL INFO cudaDriverVersion 12040
907d14e27ed8:2068:2068 [4] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2068:2068 [4] NCCL INFO Bootstrap : Using eth0:192.168.0.100<0>
907d14e27ed8:2068:2068 [4] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
907d14e27ed8:2068:2068 [4] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
907d14e27ed8:2068:2068 [4] NCCL INFO NET/Plugin: Using internal network plugin.
907d14e27ed8:2068:2068 [4] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2069:2069 [5] NCCL INFO cudaDriverVersion 12040
907d14e27ed8:2069:2069 [5] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2069:2069 [5] NCCL INFO Bootstrap : Using eth0:192.168.0.100<0>
907d14e27ed8:2069:2069 [5] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
907d14e27ed8:2069:2069 [5] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
907d14e27ed8:2069:2069 [5] NCCL INFO NET/Plugin: Using internal network plugin.
907d14e27ed8:2070:2070 [6] NCCL INFO cudaDriverVersion 12040
907d14e27ed8:2070:2070 [6] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2070:2070 [6] NCCL INFO Bootstrap : Using eth0:192.168.0.100<0>
907d14e27ed8:2070:2070 [6] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
907d14e27ed8:2070:2070 [6] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
907d14e27ed8:2070:2070 [6] NCCL INFO NET/Plugin: Using internal network plugin.
907d14e27ed8:2069:2069 [5] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2070:2070 [6] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2066:2066 [2] NCCL INFO cudaDriverVersion 12040
907d14e27ed8:2066:2066 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2066:2066 [2] NCCL INFO Bootstrap : Using eth0:192.168.0.100<0>
907d14e27ed8:2066:2066 [2] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
907d14e27ed8:2066:2066 [2] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
907d14e27ed8:2066:2066 [2] NCCL INFO NET/Plugin: Using internal network plugin.
907d14e27ed8:2066:2066 [2] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2065:2065 [1] NCCL INFO cudaDriverVersion 12040
907d14e27ed8:2065:2065 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2065:2065 [1] NCCL INFO Bootstrap : Using eth0:192.168.0.100<0>
907d14e27ed8:2065:2065 [1] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
907d14e27ed8:2065:2065 [1] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
907d14e27ed8:2065:2065 [1] NCCL INFO NET/Plugin: Using internal network plugin.
907d14e27ed8:2071:2071 [7] NCCL INFO cudaDriverVersion 12040
907d14e27ed8:2071:2071 [7] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2071:2071 [7] NCCL INFO Bootstrap : Using eth0:192.168.0.100<0>
907d14e27ed8:2071:2071 [7] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
907d14e27ed8:2071:2071 [7] NCCL INFO NET/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-net.so
907d14e27ed8:2071:2071 [7] NCCL INFO NET/Plugin: Using internal network plugin.
907d14e27ed8:2065:2065 [1] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2071:2071 [7] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2064:3426 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
907d14e27ed8:2064:3426 [0] NCCL INFO Failed to open libibverbs.so[.1]
907d14e27ed8:2064:3426 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2064:3426 [0] NCCL INFO NET/Socket : Using [0]eth0:192.168.0.100<0>
907d14e27ed8:2064:3426 [0] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2064:3426 [0] NCCL INFO Using network Socket
907d14e27ed8:2067:3427 [3] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
907d14e27ed8:2067:3427 [3] NCCL INFO Failed to open libibverbs.so[.1]
907d14e27ed8:2067:3427 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2067:3427 [3] NCCL INFO NET/Socket : Using [0]eth0:192.168.0.100<0>
907d14e27ed8:2067:3427 [3] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2067:3427 [3] NCCL INFO Using network Socket
907d14e27ed8:2068:3428 [4] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
907d14e27ed8:2068:3428 [4] NCCL INFO Failed to open libibverbs.so[.1]
907d14e27ed8:2068:3428 [4] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2068:3428 [4] NCCL INFO NET/Socket : Using [0]eth0:192.168.0.100<0>
907d14e27ed8:2068:3428 [4] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2068:3428 [4] NCCL INFO Using network Socket
907d14e27ed8:2065:3432 [1] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
907d14e27ed8:2065:3432 [1] NCCL INFO Failed to open libibverbs.so[.1]
907d14e27ed8:2065:3432 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2065:3432 [1] NCCL INFO NET/Socket : Using [0]eth0:192.168.0.100<0>
907d14e27ed8:2065:3432 [1] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2065:3432 [1] NCCL INFO Using network Socket
907d14e27ed8:2066:3431 [2] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
907d14e27ed8:2069:3429 [5] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
907d14e27ed8:2066:3431 [2] NCCL INFO Failed to open libibverbs.so[.1]
907d14e27ed8:2066:3431 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2069:3429 [5] NCCL INFO Failed to open libibverbs.so[.1]
907d14e27ed8:2069:3429 [5] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2066:3431 [2] NCCL INFO NET/Socket : Using [0]eth0:192.168.0.100<0>
907d14e27ed8:2069:3429 [5] NCCL INFO NET/Socket : Using [0]eth0:192.168.0.100<0>
907d14e27ed8:2066:3431 [2] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2069:3429 [5] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2066:3431 [2] NCCL INFO Using network Socket
907d14e27ed8:2069:3429 [5] NCCL INFO Using network Socket
907d14e27ed8:2070:3430 [6] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
907d14e27ed8:2070:3430 [6] NCCL INFO Failed to open libibverbs.so[.1]
907d14e27ed8:2070:3430 [6] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2070:3430 [6] NCCL INFO NET/Socket : Using [0]eth0:192.168.0.100<0>
907d14e27ed8:2070:3430 [6] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2070:3430 [6] NCCL INFO Using network Socket
907d14e27ed8:2071:3433 [7] NCCL INFO NCCL_IB_DISABLE set by environment to 0.
907d14e27ed8:2071:3433 [7] NCCL INFO Failed to open libibverbs.so[.1]
907d14e27ed8:2071:3433 [7] NCCL INFO NCCL_SOCKET_IFNAME set by environment to eth0
907d14e27ed8:2071:3433 [7] NCCL INFO NET/Socket : Using [0]eth0:192.168.0.100<0>
907d14e27ed8:2071:3433 [7] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2071:3433 [7] NCCL INFO Using network Socket
907d14e27ed8:2071:3433 [7] NCCL INFO ncclCommInitRank comm 0x561c2cb6dbd0 rank 7 nranks 16 cudaDev 7 nvmlDev 7 busId cf000 commId 0x8407c4b34aecc867 - Init START
907d14e27ed8:2070:3430 [6] NCCL INFO ncclCommInitRank comm 0x565256bf2850 rank 6 nranks 16 cudaDev 6 nvmlDev 6 busId ce000 commId 0x8407c4b34aecc867 - Init START
907d14e27ed8:2069:3429 [5] NCCL INFO ncclCommInitRank comm 0x563699cb4fb0 rank 5 nranks 16 cudaDev 5 nvmlDev 5 busId b6000 commId 0x8407c4b34aecc867 - Init START
907d14e27ed8:2068:3428 [4] NCCL INFO ncclCommInitRank comm 0x55a454968610 rank 4 nranks 16 cudaDev 4 nvmlDev 4 busId b5000 commId 0x8407c4b34aecc867 - Init START
907d14e27ed8:2067:3427 [3] NCCL INFO ncclCommInitRank comm 0x55990cf98e90 rank 3 nranks 16 cudaDev 3 nvmlDev 3 busId 20000 commId 0x8407c4b34aecc867 - Init START
907d14e27ed8:2066:3431 [2] NCCL INFO ncclCommInitRank comm 0x55939d27f1a0 rank 2 nranks 16 cudaDev 2 nvmlDev 2 busId 1f000 commId 0x8407c4b34aecc867 - Init START
907d14e27ed8:2065:3432 [1] NCCL INFO ncclCommInitRank comm 0x557a42936150 rank 1 nranks 16 cudaDev 1 nvmlDev 1 busId f000 commId 0x8407c4b34aecc867 - Init START
907d14e27ed8:2064:3426 [0] NCCL INFO ncclCommInitRank comm 0x55fae3cf5a80 rank 0 nranks 16 cudaDev 0 nvmlDev 0 busId e000 commId 0x8407c4b34aecc867 - Init START
907d14e27ed8:2066:3431 [2] NCCL INFO Setting affinity for GPU 2 to ffffffff
907d14e27ed8:2066:3431 [2] NCCL INFO NVLS multicast support is not available on dev 2
907d14e27ed8:2069:3429 [5] NCCL INFO Setting affinity for GPU 5 to ffffffff,00000000
907d14e27ed8:2069:3429 [5] NCCL INFO NVLS multicast support is not available on dev 5
907d14e27ed8:2070:3430 [6] NCCL INFO Setting affinity for GPU 6 to ffffffff,00000000
907d14e27ed8:2070:3430 [6] NCCL INFO NVLS multicast support is not available on dev 6
907d14e27ed8:2068:3428 [4] NCCL INFO Setting affinity for GPU 4 to ffffffff,00000000
907d14e27ed8:2068:3428 [4] NCCL INFO NVLS multicast support is not available on dev 4
907d14e27ed8:2067:3427 [3] NCCL INFO Setting affinity for GPU 3 to ffffffff
907d14e27ed8:2067:3427 [3] NCCL INFO NVLS multicast support is not available on dev 3
907d14e27ed8:2064:3426 [0] NCCL INFO Setting affinity for GPU 0 to ffffffff
907d14e27ed8:2064:3426 [0] NCCL INFO NVLS multicast support is not available on dev 0
907d14e27ed8:2065:3432 [1] NCCL INFO Setting affinity for GPU 1 to ffffffff
907d14e27ed8:2065:3432 [1] NCCL INFO NVLS multicast support is not available on dev 1
907d14e27ed8:2071:3433 [7] NCCL INFO Setting affinity for GPU 7 to ffffffff,00000000
907d14e27ed8:2071:3433 [7] NCCL INFO NVLS multicast support is not available on dev 7
907d14e27ed8:2071:3433 [7] NCCL INFO comm 0x561c2cb6dbd0 rank 7 nRanks 16 nNodes 2 localRanks 8 localRank 7 MNNVL 0
907d14e27ed8:2070:3430 [6] NCCL INFO comm 0x565256bf2850 rank 6 nRanks 16 nNodes 2 localRanks 8 localRank 6 MNNVL 0
907d14e27ed8:2071:3433 [7] NCCL INFO Trees [0] -1/-1/-1->7->6 [1] -1/-1/-1->7->6
907d14e27ed8:2070:3430 [6] NCCL INFO Trees [0] 7/-1/-1->6->5 [1] 7/-1/-1->6->5
907d14e27ed8:2071:3433 [7] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2070:3430 [6] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2069:3429 [5] NCCL INFO comm 0x563699cb4fb0 rank 5 nRanks 16 nNodes 2 localRanks 8 localRank 5 MNNVL 0
907d14e27ed8:2068:3428 [4] NCCL INFO comm 0x55a454968610 rank 4 nRanks 16 nNodes 2 localRanks 8 localRank 4 MNNVL 0
907d14e27ed8:2069:3429 [5] NCCL INFO Trees [0] 6/-1/-1->5->4 [1] 6/-1/-1->5->4
907d14e27ed8:2068:3428 [4] NCCL INFO Trees [0] 5/-1/-1->4->3 [1] 5/-1/-1->4->3
907d14e27ed8:2069:3429 [5] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2068:3428 [4] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2065:3432 [1] NCCL INFO comm 0x557a42936150 rank 1 nRanks 16 nNodes 2 localRanks 8 localRank 1 MNNVL 0
907d14e27ed8:2064:3426 [0] NCCL INFO comm 0x55fae3cf5a80 rank 0 nRanks 16 nNodes 2 localRanks 8 localRank 0 MNNVL 0
907d14e27ed8:2066:3431 [2] NCCL INFO comm 0x55939d27f1a0 rank 2 nRanks 16 nNodes 2 localRanks 8 localRank 2 MNNVL 0
907d14e27ed8:2067:3427 [3] NCCL INFO comm 0x55990cf98e90 rank 3 nRanks 16 nNodes 2 localRanks 8 localRank 3 MNNVL 0
907d14e27ed8:2065:3432 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 00/02 :    0   7   6   5   4   3   2   1   8  15  14  13  12  11  10   9
907d14e27ed8:2065:3432 [1] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 01/02 :    0   7   6   5   4   3   2   1   8  15  14  13  12  11  10   9
907d14e27ed8:2066:3431 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
907d14e27ed8:2064:3426 [0] NCCL INFO Trees [0] 1/8/-1->0->-1 [1] 1/-1/-1->0->8
907d14e27ed8:2066:3431 [2] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2064:3426 [0] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2067:3427 [3] NCCL INFO Trees [0] 4/-1/-1->3->2 [1] 4/-1/-1->3->2
907d14e27ed8:2067:3427 [3] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 00/0 : 9[1] -> 0[0] [receive] via NET/Socket/0
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 01/0 : 9[1] -> 0[0] [receive] via NET/Socket/0
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 00/0 : 0[0] -> 7[7] via P2P/CUMEM/read
907d14e27ed8:2069:3429 [5] NCCL INFO Channel 00/0 : 5[5] -> 4[4] via P2P/CUMEM/read
907d14e27ed8:2068:3428 [4] NCCL INFO Channel 00/0 : 4[4] -> 3[3] via P2P/CUMEM/read
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 01/0 : 0[0] -> 7[7] via P2P/CUMEM/read
907d14e27ed8:2066:3431 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/CUMEM/read
907d14e27ed8:2067:3427 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/CUMEM/read
907d14e27ed8:2069:3429 [5] NCCL INFO Channel 01/0 : 5[5] -> 4[4] via P2P/CUMEM/read
907d14e27ed8:2068:3428 [4] NCCL INFO Channel 01/0 : 4[4] -> 3[3] via P2P/CUMEM/read
907d14e27ed8:2066:3431 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/CUMEM/read
907d14e27ed8:2067:3427 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/CUMEM/read
907d14e27ed8:2071:3433 [7] NCCL INFO Channel 00/0 : 7[7] -> 6[6] via P2P/CUMEM/read
907d14e27ed8:2071:3433 [7] NCCL INFO Channel 01/0 : 7[7] -> 6[6] via P2P/CUMEM/read
907d14e27ed8:2065:3432 [1] NCCL INFO Channel 00/0 : 1[1] -> 8[0] [send] via NET/Socket/0
907d14e27ed8:2070:3430 [6] NCCL INFO Channel 00/0 : 6[6] -> 5[5] via P2P/CUMEM/read
907d14e27ed8:2065:3432 [1] NCCL INFO Channel 01/0 : 1[1] -> 8[0] [send] via NET/Socket/0
907d14e27ed8:2070:3430 [6] NCCL INFO Channel 01/0 : 6[6] -> 5[5] via P2P/CUMEM/read
907d14e27ed8:2065:3432 [1] NCCL INFO Connected all rings
907d14e27ed8:2066:3431 [2] NCCL INFO Connected all rings
907d14e27ed8:2064:3426 [0] NCCL INFO Connected all rings
907d14e27ed8:2065:3432 [1] NCCL INFO Channel 00/0 : 1[1] -> 2[2] via P2P/CUMEM/read
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM/read
907d14e27ed8:2065:3432 [1] NCCL INFO Channel 01/0 : 1[1] -> 2[2] via P2P/CUMEM/read
907d14e27ed8:2067:3427 [3] NCCL INFO Connected all rings
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM/read
907d14e27ed8:2066:3431 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/CUMEM/read
907d14e27ed8:2066:3431 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/CUMEM/read
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 00/0 : 8[0] -> 0[0] [receive] via NET/Socket/0
907d14e27ed8:2065:3432 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/CUMEM/read
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 01/0 : 8[0] -> 0[0] [receive] via NET/Socket/0
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 00/0 : 0[0] -> 8[0] [send] via NET/Socket/0
907d14e27ed8:2064:3426 [0] NCCL INFO Channel 01/0 : 0[0] -> 8[0] [send] via NET/Socket/0
907d14e27ed8:2068:3428 [4] NCCL INFO Connected all rings
907d14e27ed8:2065:3432 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/CUMEM/read
907d14e27ed8:2067:3427 [3] NCCL INFO Channel 00/0 : 3[3] -> 4[4] via P2P/CUMEM/read
907d14e27ed8:2067:3427 [3] NCCL INFO Channel 01/0 : 3[3] -> 4[4] via P2P/CUMEM/read
907d14e27ed8:2068:3428 [4] NCCL INFO Channel 00/0 : 4[4] -> 5[5] via P2P/CUMEM/read
907d14e27ed8:2069:3429 [5] NCCL INFO Connected all rings
907d14e27ed8:2071:3433 [7] NCCL INFO Connected all rings
907d14e27ed8:2070:3430 [6] NCCL INFO Connected all rings
907d14e27ed8:2068:3428 [4] NCCL INFO Channel 01/0 : 4[4] -> 5[5] via P2P/CUMEM/read
907d14e27ed8:2069:3429 [5] NCCL INFO Channel 00/0 : 5[5] -> 6[6] via P2P/CUMEM/read
907d14e27ed8:2070:3430 [6] NCCL INFO Channel 00/0 : 6[6] -> 7[7] via P2P/CUMEM/read
907d14e27ed8:2070:3430 [6] NCCL INFO Channel 01/0 : 6[6] -> 7[7] via P2P/CUMEM/read
907d14e27ed8:2069:3429 [5] NCCL INFO Channel 01/0 : 5[5] -> 6[6] via P2P/CUMEM/read
907d14e27ed8:2067:3427 [3] NCCL INFO Connected all trees
907d14e27ed8:2067:3427 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2067:3427 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2071:3433 [7] NCCL INFO Connected all trees
907d14e27ed8:2071:3433 [7] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2071:3433 [7] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2066:3431 [2] NCCL INFO Connected all trees
907d14e27ed8:2066:3431 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2066:3431 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2065:3432 [1] NCCL INFO Connected all trees
907d14e27ed8:2064:3426 [0] NCCL INFO Connected all trees
907d14e27ed8:2065:3432 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2065:3432 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2064:3426 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2064:3426 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2070:3430 [6] NCCL INFO Connected all trees
907d14e27ed8:2070:3430 [6] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2070:3430 [6] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2068:3428 [4] NCCL INFO Connected all trees
907d14e27ed8:2069:3429 [5] NCCL INFO Connected all trees
907d14e27ed8:2068:3428 [4] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2068:3428 [4] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2069:3429 [5] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2069:3429 [5] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2070:3430 [6] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
907d14e27ed8:2068:3428 [4] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
907d14e27ed8:2069:3429 [5] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
907d14e27ed8:2070:3430 [6] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
907d14e27ed8:2068:3428 [4] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
907d14e27ed8:2069:3429 [5] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
907d14e27ed8:2070:3430 [6] NCCL INFO ncclCommInitRank comm 0x565256bf2850 rank 6 nranks 16 cudaDev 6 nvmlDev 6 busId ce000 commId 0x8407c4b34aecc867 - Init COMPLETE
907d14e27ed8:2068:3428 [4] NCCL INFO ncclCommInitRank comm 0x55a454968610 rank 4 nranks 16 cudaDev 4 nvmlDev 4 busId b5000 commId 0x8407c4b34aecc867 - Init COMPLETE
907d14e27ed8:2069:3429 [5] NCCL INFO ncclCommInitRank comm 0x563699cb4fb0 rank 5 nranks 16 cudaDev 5 nvmlDev 5 busId b6000 commId 0x8407c4b34aecc867 - Init COMPLETE
907d14e27ed8:2065:3432 [1] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
907d14e27ed8:2065:3432 [1] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
907d14e27ed8:2065:3432 [1] NCCL INFO ncclCommInitRank comm 0x557a42936150 rank 1 nranks 16 cudaDev 1 nvmlDev 1 busId f000 commId 0x8407c4b34aecc867 - Init COMPLETE
907d14e27ed8:2064:3426 [0] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
907d14e27ed8:2064:3426 [0] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
907d14e27ed8:2064:3426 [0] NCCL INFO ncclCommInitRank comm 0x55fae3cf5a80 rank 0 nranks 16 cudaDev 0 nvmlDev 0 busId e000 commId 0x8407c4b34aecc867 - Init COMPLETE
907d14e27ed8:2071:3433 [7] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
907d14e27ed8:2071:3433 [7] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
907d14e27ed8:2071:3433 [7] NCCL INFO ncclCommInitRank comm 0x561c2cb6dbd0 rank 7 nranks 16 cudaDev 7 nvmlDev 7 busId cf000 commId 0x8407c4b34aecc867 - Init COMPLETE
907d14e27ed8:2067:3427 [3] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
907d14e27ed8:2067:3427 [3] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
907d14e27ed8:2067:3427 [3] NCCL INFO ncclCommInitRank comm 0x55990cf98e90 rank 3 nranks 16 cudaDev 3 nvmlDev 3 busId 20000 commId 0x8407c4b34aecc867 - Init COMPLETE
907d14e27ed8:2066:3431 [2] NCCL INFO TUNER/Plugin: Plugin load returned 2 : libnccl-net.so: cannot open shared object file: No such file or directory : when loading libnccl-tuner.so
907d14e27ed8:2066:3431 [2] NCCL INFO TUNER/Plugin: Using internal tuner plugin.
907d14e27ed8:2066:3431 [2] NCCL INFO ncclCommInitRank comm 0x55939d27f1a0 rank 2 nranks 16 cudaDev 2 nvmlDev 2 busId 1f000 commId 0x8407c4b34aecc867 - Init COMPLETE
Running tokenizer on dataset (num_proc=16):   0% 0/1090 [00:00<?, ? examples/s]Running tokenizer on dataset (num_proc=16):   6% 69/1090 [00:00<00:06, 149.46 examples/s]Running tokenizer on dataset (num_proc=16):  19% 206/1090 [00:00<00:02, 383.83 examples/s]Running tokenizer on dataset (num_proc=16):  38% 410/1090 [00:00<00:01, 573.33 examples/s]Running tokenizer on dataset (num_proc=16):  50% 546/1090 [00:01<00:00, 654.52 examples/s]Running tokenizer on dataset (num_proc=16):  69% 750/1090 [00:01<00:00, 722.36 examples/s]Running tokenizer on dataset (num_proc=16):  81% 886/1090 [00:01<00:00, 824.70 examples/s]Running tokenizer on dataset (num_proc=16):  94% 1022/1090 [00:01<00:00, 878.01 examples/s]Running tokenizer on dataset (num_proc=16): 100% 1090/1090 [00:01<00:00, 652.67 examples/s]
training example:
input_ids:
[103929, 98380, 102021, 11319, 27, 91, 408, 3575, 4326, 91, 29, 103929, 100772, 102021, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 104139, 100661, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 104139, 112526, 11319, 27, 91, 408, 3575, 4326, 91, 29, 103929, 100160, 102021, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 100678, 47606, 11319, 27, 91, 408, 3575, 4326, 91, 29, 103929, 101398, 102021, 11319, 27, 91, 408, 3575, 4326, 91, 29, 103929, 104559, 102021, 11319, 27, 91, 408, 3575, 4326, 91, 29, 103929, 99257, 102021, 11319, 27, 91, 408, 3575, 4326, 91, 29, 103929, 104116, 102021, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 100007, 53481, 99283, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 106961, 110498, 109916, 99604, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 18830, 113065, 101037, 11319, 27, 91, 408, 3575, 4326, 91, 29, 102762, 100153, 107494, 107120, 101037, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 100007, 54542, 20002, 105918, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 100006, 99553, 102224, 109963, 100364, 11319, 27, 91, 408, 3575, 4326, 91, 29, 56568, 32664, 20002, 101080, 103936, 104139, 104108, 11319, 27, 91, 408, 3575, 4326, 91, 29, 103929, 102104, 64471, 73670, 109874, 11319, 27, 91, 408, 3575, 4326, 91, 29, 105043, 5002, 15469, 100013, 9370, 99245, 11319, 27, 91, 408, 3575, 4326, 91, 29, 100622, 15672, 38, 2828, 3837, 103929, 98380, 102021, 11319, 27, 91, 408, 3575, 4326, 91, 29, 5002, 15469, 107781, 103963, 56568, 11319, 27, 91, 408, 3575, 4326, 91, 29, 105043, 5002, 15469, 100013, 9370, 15672, 38, 2828, 101037, 11319, 27, 91, 408, 3575, 4326, 91, 29, 74785, 264, 1882, 315, 3259, 1884, 20352, 15757, 91, 408, 3575, 4326, 91, 29, 8963, 279, 2701, 11652, 1667, 264, 73350, 25, 576, 1803, 85610, 6157, 15757, 91, 408, 3575, 4326, 91, 29, 8078, 264, 65243, 5693, 311, 11926, 33878, 15757, 91, 408, 3575, 4326, 91, 29, 641, 684, 264, 501, 3409, 553, 34171, 1378, 6350, 4244, 15757, 91, 408, 3575, 4326, 91, 29, 35127, 458, 3110, 315, 264, 2618, 429, 264, 6366, 646, 653, 2664, 1091, 264, 3738, 1660, 15757, 91, 408, 3575, 4326, 91, 29, 22043, 279, 5029, 315, 264, 21495, 11, 1477, 700, 1181, 46342, 624, 16384, 220, 16, 284, 220, 19, 198, 16384, 220, 17, 284, 220, 21, 198, 16384, 220, 18, 284, 220, 23, 27, 91, 408, 3575, 4326, 91, 29, 4021, 458, 7373, 220, 16, 19, 15, 3668, 22272, 1736, 27, 91, 408, 3575, 4326, 91, 29, 1336, 13373, 264, 1140, 315, 279, 1909, 220, 20, 23677, 4217, 304, 220, 17, 15, 17, 16, 15757, 91, 408, 3575, 4326, 91, 29, 58465, 539, 419, 11652, 311, 5263, 31273, 198, 785, 4522, 315, 1059, 1660, 773, 33200, 1865, 752, 15289, 27, 91, 408, 3575, 4326, 91, 29, 840, 20772, 279, 11799, 1948, 19654, 323, 55569, 27, 91, 408, 3575, 4326, 91, 29, 31115, 264, 825, 1331, 18380, 2265, 369, 264, 11521, 11116, 15757, 91, 408, 3575, 4326, 91, 29, 840, 20772, 279, 7286, 315, 384, 41585, 15757, 91, 408, 3575, 4326, 91, 29, 20470, 458, 9342, 311, 15442, 279, 40165, 315, 279, 10981, 1714, 624, 2008, 19586, 6730, 25, 60477, 40956, 27, 91, 408, 3575, 4326, 91, 29, 31115, 264, 1140, 315, 4236, 2155, 6467, 911, 8038, 15757, 91, 408, 3575, 4326, 91, 29, 65077, 26413, 1045, 7488, 429, 1410, 1281, 458, 304, 28045, 975, 6438, 803, 22570, 15757, 91, 408, 3575, 4326, 91, 29, 65077, 26413, 264, 1140, 315, 15311, 369, 264, 6548, 8017, 27, 91, 408, 3575, 4326, 91, 29, 58465, 1247, 279, 11652, 773, 429, 432, 594, 304, 279, 3042, 42687, 624, 7941, 1030, 6439, 518, 279, 2813, 369, 279, 3267, 220, 18, 1635, 15757, 91, 408, 3575, 4326, 91, 29, 2589, 2689, 279, 3897, 21646, 311, 1281, 432, 803, 69846, 624, 10234, 1521, 279, 59881, 5312, 279, 5636, 75414, 91, 408, 3575, 4326, 91, 29, 4021, 458, 15235, 6236, 6331, 27, 91, 408, 3575, 4326, 91, 29, 840, 20772, 1128, 264, 16224, 66767, 374, 15757, 91, 408, 3575, 4326, 91, 29, 4021, 264, 3364, 15860, 264, 7404, 8644, 323, 458, 45740, 15757, 91, 408, 3575, 4326, 91, 29, 53544, 279, 1790, 17795, 5185, 2661, 279, 17795, 8500, 624, 35, 468, 479, 425, 356, 27, 91, 408, 3575, 4326, 91, 29, 3830, 279, 1140, 315, 4244, 11, 10542, 279, 1378, 37328, 23628, 3196, 7831, 315, 279, 3409, 364, 258, 38768, 23569, 641, 38768, 27, 91, 408, 3575, 4326, 91, 29, 675, 2326, 90871, 429, 12598, 1265, 633, 27, 91, 408, 3575, 4326, 91, 29, 35127, 752, 1378, 10295, 315, 32168, 4802, 8173, 15757, 91, 408, 3575, 4326, 91, 29, 10231, 279, 6467, 1119, 1378, 5203, 11, 16989, 323, 2477, 73431, 624, 61686, 594, 50579, 304, 88924, 11, 576, 17358, 304, 279, 21341, 11, 13630, 4492, 596, 11, 3017, 4509, 49328, 27, 91, 408, 3575, 4326, 91, 29, 3838, 525, 279, 7567, 315, 50482, 75414, 91, 408, 3575, 4326, 91, 29, 4340, 1035, 498, 6923, 4194, 5109, 1948, 220, 16, 323, 220, 16, 15, 304, 7943, 75414, 91, 408, 3575, 4326, 91, 29, 56808, 279, 2701, 3491, 25, 220, 24, 481, 220, 17, 856, 220, 18, 27, 91, 408, 3575, 4326, 91, 29, 14449, 304, 279, 10113, 1667, 264, 3409, 429, 1850, 44595, 279, 11652, 624, 785, 3283, 572, 10113, 24481, 304, 264, 12045, 6193, 315, 96283, 30743, 15757, 91, 408, 3575, 4326, 91, 29, 74785, 1246, 5662, 6832, 374, 1483, 304, 419, 1849, 624, 32, 1849, 429, 44699, 1424, 66283, 18509, 15757, 91, 408, 3575, 4326, 91, 29, 31115, 264, 7327, 911, 18707, 15757, 91, 408, 3575, 4326, 91, 29, 675, 825, 315, 279, 23091, 315, 8038, 27, 91, 408, 3575, 4326, 91, 29, 7985, 279, 2487, 315, 458, 2551, 311, 21399, 1251, 311, 264, 62560, 389, 279, 2661, 8544, 624, 26406, 25, 2585, 311, 990, 821, 27875, 311, 7269, 697, 2562, 15757, 91, 408, 3575, 4326, 91, 29, 2212, 220, 18, 10295, 311, 279, 2701, 11652, 624, 63907, 9170, 304, 279, 3639, 4180, 646, 1102, 304, 1112, 27, 91, 408, 3575, 4326, 91, 29, 82345, 279, 2701, 3717, 438, 830, 11, 895, 11, 476, 35118, 13, 9258, 220, 16, 369]
inputs:
你的功能是什么？<|end_of_text|>你的特点是什么？<|end_of_text|>你有什么优势？<|end_of_text|>你有什么特长？<|end_of_text|>你的目标是什么？<|end_of_text|>你为什么存在？<|end_of_text|>你的使命是什么？<|end_of_text|>你的职责是什么？<|end_of_text|>你的工作是什么？<|end_of_text|>你的定位是什么？<|end_of_text|>你如何描述自己？<|end_of_text|>你与其他助手有何不同？<|end_of_text|>你有创造力吗？<|end_of_text|>你会保护用户的隐私吗？<|end_of_text|>你如何处理用户的数据？<|end_of_text|>你能够提供哪些类型的帮助？<|end_of_text|>你对用户提出的问题有什么限制？<|end_of_text|>你的回答是否可以信赖？<|end_of_text|>你是OpenAI开发的什么？<|end_of_text|>作为ChatGPT，你的功能是什么？<|end_of_text|>OpenAI为什么要制作你？<|end_of_text|>你是OpenAI开发的ChatGPT吗？<|end_of_text|>Describe a process of making crepes.<|end_of_text|>Transform the following sentence using a synonym: The car sped quickly.<|end_of_text|>Make a persuasive argument to promote recycling.<|end_of_text|>Invent a new word by combining two existing words.<|end_of_text|>Give an example of a job that a computer can do better than a human being.<|end_of_text|>Given the parameters of a triangle, find out its perimeter.
Side 1 = 4
Side 2 = 6
Side 3 = 8<|end_of_text|>Create an effective 140 character twitter post<|end_of_text|>Produce a list of the top 5 NHL players in 2021.<|end_of_text|>Reword this sentence to increase clarity
The idea of her being so brave made me smile<|end_of_text|>Explain the differences between birds and mammals<|end_of_text|>Generate a one-sentence title for a creative recipe.<|end_of_text|>Explain the concept of e-commerce.<|end_of_text|>Design an experiment to evaluate the efficacy of the proposed method.
Proposed Method: Neural persistence<|end_of_text|>Generate a list of five different books about science.<|end_of_text|>Brainstorm some activities that could make an in-person work meeting more engaging.<|end_of_text|>Brainstorm a list of titles for a photo album<|end_of_text|>Rewrite the sentence so that it's in the present tense.
She had worked at the company for the past 3 years.<|end_of_text|>Adapt the provided joke to make it more humorous.
Why did the frog cross the road?<|end_of_text|>Create an AI chatbot<|end_of_text|>Explain what a circuit breaker is.<|end_of_text|>Create a story involving a talking mouse and an elephant.<|end_of_text|>Predict the next musical note given the musical sequence.
D E G B C<|end_of_text|>From the list of words, identify the two-word compound antonym of the word 'injustice'.
Injustice<|end_of_text|>Name three vaccinations that adults should get<|end_of_text|>Give me two examples of renewable energy sources.<|end_of_text|>Sort the books into two groups, fiction and non-fiction.
Alice's Adventures in Wonderland, The Cat in the Hat, Wild Swans, My Struggle<|end_of_text|>What are the benefits of exercising?<|end_of_text|>How would you generate random numbers between 1 and 10 in Java?<|end_of_text|>Resolve the following problem: 9 - 2 x 3<|end_of_text|>Fill in the blank using a word that best completes the sentence.
The city was blanketed in a thick layer of eerie ____.<|end_of_text|>Describe how machine learning is used in this system.
A system that recognizes hand-written digits.<|end_of_text|>Generate a rap about dreams.<|end_of_text|>Name one of the branches of science<|end_of_text|>Write the body of an email to invite people to a webinar on the given topic.
Topic: How to use data analytics to improve your business.<|end_of_text|>Add 3 examples to the following sentence.
Gun violence in the United States can result in...<|end_of_text|>Evaluate the following claim as true, false, or uncertain. Output 1 for
[INFO|configuration_utils.py:750] 2025-08-18 12:56:16,949 >> loading configuration file /data/Qwen2.5-32B-Instruct/config.json
[INFO|configuration_utils.py:817] 2025-08-18 12:56:16,950 >> Model config Qwen2Config {
  "architectures": [
    "Qwen2ForCausalLM"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 5120,
  "initializer_range": 0.02,
  "intermediate_size": 27648,
  "layer_types": [
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention"
  ],
  "max_position_embeddings": 32768,
  "max_window_layers": 70,
  "model_type": "qwen2",
  "num_attention_heads": 40,
  "num_hidden_layers": 64,
  "num_key_value_heads": 8,
  "rms_norm_eps": 1e-06,
  "rope_scaling": null,
  "rope_theta": 1000000.0,
  "sliding_window": null,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.55.0",
  "use_cache": true,
  "use_sliding_window": false,
  "vocab_size": 152064
}

[INFO|2025-08-18 12:56:16] llamafactory.model.model_utils.kv_cache:143 >> KV cache is disabled during training.
[INFO|modeling_utils.py:1305] 2025-08-18 12:56:17,054 >> loading weights file /data/Qwen2.5-32B-Instruct/model.safetensors.index.json
[INFO|modeling_utils.py:4363] 2025-08-18 12:56:17,054 >> Detected DeepSpeed ZeRO-3: activating zero.init() for this model
[2025-08-18 12:56:17,055] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[INFO|configuration_utils.py:1098] 2025-08-18 12:56:17,066 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "use_cache": false
}

[2025-08-18 12:56:17,169] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[2025-08-18 12:56:17,171] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[2025-08-18 12:56:17,173] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[2025-08-18 12:56:17,173] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[2025-08-18 12:56:17,176] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[2025-08-18 12:56:17,176] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[2025-08-18 12:56:17,181] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[2025-08-18 12:57:15,317] [INFO] [partition_parameters.py:348:__exit__] finished initializing model - num_params = 771, num_elems = 32.76B
Loading checkpoint shards:   0% 0/17 [00:00<?, ?it/s]Loading checkpoint shards:   0% 0/17 [00:00<?, ?it/s]Loading checkpoint shards:   0% 0/17 [00:00<?, ?it/s]Loading checkpoint shards:   0% 0/17 [00:00<?, ?it/s]Loading checkpoint shards:   0% 0/17 [00:00<?, ?it/s]Loading checkpoint shards:   0% 0/17 [00:00<?, ?it/s]Loading checkpoint shards:   0% 0/17 [00:00<?, ?it/s]Loading checkpoint shards:   0% 0/17 [00:00<?, ?it/s]Loading checkpoint shards:   6% 1/17 [00:08<02:14,  8.38s/it]Loading checkpoint shards:   6% 1/17 [00:08<02:13,  8.37s/it]Loading checkpoint shards:   6% 1/17 [00:08<02:14,  8.39s/it]Loading checkpoint shards:   6% 1/17 [00:08<02:14,  8.40s/it]Loading checkpoint shards:   6% 1/17 [00:08<02:13,  8.36s/it]Loading checkpoint shards:   6% 1/17 [00:08<02:13,  8.37s/it]Loading checkpoint shards:   6% 1/17 [00:08<02:14,  8.41s/it]Loading checkpoint shards:   6% 1/17 [00:09<02:26,  9.13s/it]Loading checkpoint shards:  12% 2/17 [00:15<01:58,  7.88s/it]Loading checkpoint shards:  12% 2/17 [00:15<01:58,  7.88s/it]Loading checkpoint shards:  12% 2/17 [00:15<01:58,  7.88s/it]Loading checkpoint shards:  12% 2/17 [00:15<01:58,  7.89s/it]Loading checkpoint shards:  12% 2/17 [00:15<01:58,  7.90s/it]Loading checkpoint shards:  12% 2/17 [00:15<01:58,  7.88s/it]Loading checkpoint shards:  12% 2/17 [00:15<01:58,  7.89s/it]Loading checkpoint shards:  12% 2/17 [00:16<02:02,  8.20s/it]Loading checkpoint shards:  18% 3/17 [00:23<01:48,  7.74s/it]Loading checkpoint shards:  18% 3/17 [00:23<01:48,  7.74s/it]Loading checkpoint shards:  18% 3/17 [00:23<01:48,  7.75s/it]Loading checkpoint shards:  18% 3/17 [00:23<01:48,  7.75s/it]Loading checkpoint shards:  18% 3/17 [00:23<01:48,  7.75s/it]Loading checkpoint shards:  18% 3/17 [00:23<01:48,  7.75s/it]Loading checkpoint shards:  18% 3/17 [00:23<01:48,  7.74s/it]Loading checkpoint shards:  18% 3/17 [00:24<01:50,  7.92s/it]Loading checkpoint shards:  24% 4/17 [00:31<01:39,  7.68s/it]Loading checkpoint shards:  24% 4/17 [00:31<01:39,  7.68s/it]Loading checkpoint shards:  24% 4/17 [00:31<01:39,  7.68s/it]Loading checkpoint shards:  24% 4/17 [00:31<01:39,  7.68s/it]Loading checkpoint shards:  24% 4/17 [00:31<01:39,  7.68s/it]Loading checkpoint shards:  24% 4/17 [00:31<01:39,  7.68s/it]Loading checkpoint shards:  24% 4/17 [00:31<01:39,  7.68s/it]Loading checkpoint shards:  24% 4/17 [00:31<01:41,  7.78s/it]Loading checkpoint shards:  29% 5/17 [00:38<01:31,  7.63s/it]Loading checkpoint shards:  29% 5/17 [00:38<01:31,  7.63s/it]Loading checkpoint shards:  29% 5/17 [00:38<01:31,  7.63s/it]Loading checkpoint shards:  29% 5/17 [00:38<01:31,  7.63s/it]Loading checkpoint shards:  29% 5/17 [00:38<01:31,  7.63s/it]Loading checkpoint shards:  29% 5/17 [00:38<01:31,  7.63s/it]Loading checkpoint shards:  29% 5/17 [00:38<01:31,  7.63s/it]Loading checkpoint shards:  29% 5/17 [00:39<01:32,  7.69s/it]Loading checkpoint shards:  35% 6/17 [00:46<01:23,  7.62s/it]Loading checkpoint shards:  35% 6/17 [00:46<01:23,  7.62s/it]Loading checkpoint shards:  35% 6/17 [00:46<01:23,  7.62s/it]Loading checkpoint shards:  35% 6/17 [00:46<01:23,  7.62s/it]Loading checkpoint shards:  35% 6/17 [00:46<01:23,  7.62s/it]Loading checkpoint shards:  35% 6/17 [00:46<01:23,  7.62s/it]Loading checkpoint shards:  35% 6/17 [00:46<01:23,  7.62s/it]Loading checkpoint shards:  35% 6/17 [00:46<01:24,  7.66s/it]Loading checkpoint shards:  41% 7/17 [00:53<01:15,  7.59s/it]Loading checkpoint shards:  41% 7/17 [00:53<01:15,  7.59s/it]Loading checkpoint shards:  41% 7/17 [00:53<01:15,  7.59s/it]Loading checkpoint shards:  41% 7/17 [00:53<01:15,  7.59s/it]Loading checkpoint shards:  41% 7/17 [00:53<01:15,  7.59s/it]Loading checkpoint shards:  41% 7/17 [00:53<01:15,  7.59s/it]Loading checkpoint shards:  41% 7/17 [00:53<01:15,  7.59s/it]Loading checkpoint shards:  41% 7/17 [00:54<01:16,  7.62s/it]Loading checkpoint shards:  47% 8/17 [01:01<01:08,  7.58s/it]Loading checkpoint shards:  47% 8/17 [01:01<01:08,  7.58s/it]Loading checkpoint shards:  47% 8/17 [01:01<01:08,  7.58s/it]Loading checkpoint shards:  47% 8/17 [01:01<01:08,  7.58s/it]Loading checkpoint shards:  47% 8/17 [01:01<01:08,  7.58s/it]Loading checkpoint shards:  47% 8/17 [01:01<01:08,  7.58s/it]Loading checkpoint shards:  47% 8/17 [01:01<01:08,  7.58s/it]Loading checkpoint shards:  47% 8/17 [01:02<01:08,  7.60s/it]Loading checkpoint shards:  53% 9/17 [01:08<01:00,  7.57s/it]Loading checkpoint shards:  53% 9/17 [01:08<01:00,  7.57s/it]Loading checkpoint shards:  53% 9/17 [01:08<01:00,  7.57s/it]Loading checkpoint shards:  53% 9/17 [01:08<01:00,  7.57s/it]Loading checkpoint shards:  53% 9/17 [01:08<01:00,  7.57s/it]Loading checkpoint shards:  53% 9/17 [01:08<01:00,  7.57s/it]Loading checkpoint shards:  53% 9/17 [01:08<01:00,  7.57s/it]Loading checkpoint shards:  53% 9/17 [01:09<01:00,  7.58s/it]Loading checkpoint shards:  59% 10/17 [01:16<00:53,  7.57s/it]Loading checkpoint shards:  59% 10/17 [01:16<00:53,  7.57s/it]Loading checkpoint shards:  59% 10/17 [01:16<00:53,  7.57s/it]Loading checkpoint shards:  59% 10/17 [01:16<00:53,  7.57s/it]Loading checkpoint shards:  59% 10/17 [01:16<00:53,  7.57s/it]Loading checkpoint shards:  59% 10/17 [01:16<00:53,  7.57s/it]Loading checkpoint shards:  59% 10/17 [01:16<00:53,  7.57s/it]Loading checkpoint shards:  59% 10/17 [01:17<00:53,  7.58s/it]Loading checkpoint shards:  65% 11/17 [01:24<00:45,  7.58s/it]Loading checkpoint shards:  65% 11/17 [01:24<00:45,  7.58s/it]Loading checkpoint shards:  65% 11/17 [01:24<00:45,  7.58s/it]Loading checkpoint shards:  65% 11/17 [01:24<00:45,  7.58s/it]Loading checkpoint shards:  65% 11/17 [01:24<00:45,  7.58s/it]Loading checkpoint shards:  65% 11/17 [01:24<00:45,  7.58s/it]Loading checkpoint shards:  65% 11/17 [01:23<00:45,  7.58s/it]Loading checkpoint shards:  65% 11/17 [01:24<00:45,  7.58s/it]Loading checkpoint shards:  71% 12/17 [01:31<00:37,  7.58s/it]Loading checkpoint shards:  71% 12/17 [01:31<00:37,  7.58s/it]Loading checkpoint shards:  71% 12/17 [01:31<00:37,  7.58s/it]Loading checkpoint shards:  71% 12/17 [01:31<00:37,  7.58s/it]Loading checkpoint shards:  71% 12/17 [01:31<00:37,  7.58s/it]Loading checkpoint shards:  71% 12/17 [01:31<00:37,  7.58s/it]Loading checkpoint shards:  71% 12/17 [01:31<00:37,  7.58s/it]Loading checkpoint shards:  71% 12/17 [01:32<00:37,  7.58s/it]Loading checkpoint shards:  76% 13/17 [01:39<00:30,  7.58s/it]Loading checkpoint shards:  76% 13/17 [01:39<00:30,  7.58s/it]Loading checkpoint shards:  76% 13/17 [01:39<00:30,  7.58s/it]Loading checkpoint shards:  76% 13/17 [01:39<00:30,  7.58s/it]Loading checkpoint shards:  76% 13/17 [01:39<00:30,  7.58s/it]Loading checkpoint shards:  76% 13/17 [01:39<00:30,  7.58s/it]Loading checkpoint shards:  76% 13/17 [01:39<00:30,  7.58s/it]Loading checkpoint shards:  76% 13/17 [01:39<00:30,  7.58s/it]Loading checkpoint shards:  82% 14/17 [01:46<00:22,  7.59s/it]Loading checkpoint shards:  82% 14/17 [01:46<00:22,  7.59s/it]Loading checkpoint shards:  82% 14/17 [01:46<00:22,  7.59s/it]Loading checkpoint shards:  82% 14/17 [01:46<00:22,  7.59s/it]Loading checkpoint shards:  82% 14/17 [01:46<00:22,  7.59s/it]Loading checkpoint shards:  82% 14/17 [01:46<00:22,  7.59s/it]Loading checkpoint shards:  82% 14/17 [01:46<00:22,  7.59s/it]Loading checkpoint shards:  82% 14/17 [01:47<00:22,  7.59s/it]Loading checkpoint shards:  88% 15/17 [01:54<00:15,  7.60s/it]Loading checkpoint shards:  88% 15/17 [01:54<00:15,  7.60s/it]Loading checkpoint shards:  88% 15/17 [01:54<00:15,  7.60s/it]Loading checkpoint shards:  88% 15/17 [01:54<00:15,  7.60s/it]Loading checkpoint shards:  88% 15/17 [01:54<00:15,  7.60s/it]Loading checkpoint shards:  88% 15/17 [01:54<00:15,  7.60s/it]Loading checkpoint shards:  88% 15/17 [01:54<00:15,  7.60s/it]Loading checkpoint shards:  88% 15/17 [01:55<00:15,  7.60s/it]Loading checkpoint shards:  94% 16/17 [02:01<00:07,  7.59s/it]Loading checkpoint shards:  94% 16/17 [02:01<00:07,  7.59s/it]Loading checkpoint shards:  94% 16/17 [02:01<00:07,  7.59s/it]Loading checkpoint shards:  94% 16/17 [02:01<00:07,  7.59s/it]Loading checkpoint shards:  94% 16/17 [02:02<00:07,  7.59s/it]Loading checkpoint shards:  94% 16/17 [02:02<00:07,  7.59s/it]Loading checkpoint shards:  94% 16/17 [02:01<00:07,  7.59s/it]Loading checkpoint shards:  94% 16/17 [02:02<00:07,  7.59s/it]Loading checkpoint shards: 100% 17/17 [02:03<00:00,  5.88s/it]Loading checkpoint shards: 100% 17/17 [02:03<00:00,  7.29s/it]
Loading checkpoint shards: 100% 17/17 [02:03<00:00,  5.88s/it]Loading checkpoint shards: 100% 17/17 [02:03<00:00,  5.88s/it]Loading checkpoint shards: 100% 17/17 [02:03<00:00,  7.29s/it]
Loading checkpoint shards: 100% 17/17 [02:03<00:00,  7.29s/it]
Loading checkpoint shards: 100% 17/17 [02:03<00:00,  5.88s/it]Loading checkpoint shards: 100% 17/17 [02:03<00:00,  5.88s/it]Loading checkpoint shards: 100% 17/17 [02:03<00:00,  5.88s/it]Loading checkpoint shards: 100% 17/17 [02:03<00:00,  5.88s/it]Loading checkpoint shards: 100% 17/17 [02:03<00:00,  7.29s/it]
Loading checkpoint shards: 100% 17/17 [02:03<00:00,  7.29s/it]
Loading checkpoint shards: 100% 17/17 [02:03<00:00,  7.29s/it]
Loading checkpoint shards: 100% 17/17 [02:03<00:00,  7.29s/it]
Loading checkpoint shards: 100% 17/17 [02:07<00:00,  6.67s/it]Loading checkpoint shards: 100% 17/17 [02:07<00:00,  7.49s/it]
[INFO|modeling_utils.py:5606] 2025-08-18 12:59:22,622 >> All model checkpoint weights were used when initializing Qwen2ForCausalLM.

[INFO|modeling_utils.py:5614] 2025-08-18 12:59:22,623 >> All the weights of Qwen2ForCausalLM were initialized from the model checkpoint at /data/Qwen2.5-32B-Instruct.
If your task is similar to the task the model of the checkpoint was trained on, you can already use Qwen2ForCausalLM for predictions without further training.
[INFO|configuration_utils.py:1051] 2025-08-18 12:59:22,627 >> loading configuration file /data/Qwen2.5-32B-Instruct/generation_config.json
[INFO|configuration_utils.py:1098] 2025-08-18 12:59:22,627 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "repetition_penalty": 1.05,
  "temperature": 0.7,
  "top_k": 20,
  "top_p": 0.8
}

[INFO|2025-08-18 12:59:22] llamafactory.model.model_utils.checkpointing:143 >> Gradient checkpointing enabled.
[INFO|2025-08-18 12:59:22] llamafactory.model.model_utils.attention:143 >> Using torch SDPA for faster training and inference.
[INFO|2025-08-18 12:59:22] llamafactory.model.adapter:143 >> DeepSpeed ZeRO3 detected, remaining trainable params in float32.
[INFO|2025-08-18 12:59:22] llamafactory.model.adapter:143 >> Fine-tuning method: LoRA
[INFO|2025-08-18 12:59:22] llamafactory.model.model_utils.misc:143 >> Found linear modules: o_proj,up_proj,k_proj,q_proj,gate_proj,v_proj,down_proj
[INFO|2025-08-18 12:59:31] llamafactory.model.loader:143 >> trainable params: 67,108,864 || all params: 32,830,985,216 || trainable%: 0.2044
[INFO|trainer.py:757] 2025-08-18 12:59:32,051 >> Using auto half precision backend
[WARNING|2025-08-18 12:59:32] llamafactory.train.callbacks:154 >> Previous trainer log in this folder will be deleted.
[2025-08-18 12:59:32,464] [INFO] [logging.py:107:log_dist] [Rank 0] DeepSpeed info: version=0.16.9, git-hash=unknown, git-branch=unknown
[2025-08-18 12:59:32,465] [INFO] [config.py:735:__init__] Config mesh_device None world_size = 16
[2025-08-18 12:59:32,526] [INFO] [logging.py:107:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2025-08-18 12:59:32,532] [INFO] [logging.py:107:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2025-08-18 12:59:32,532] [INFO] [logging.py:107:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-08-18 12:59:32,630] [INFO] [logging.py:107:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2025-08-18 12:59:32,630] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2025-08-18 12:59:32,630] [INFO] [logging.py:107:log_dist] [Rank 0] Creating fp16 ZeRO stage 3 optimizer, MiCS is enabled False, Hierarchical params gather False
[2025-08-18 12:59:32,630] [INFO] [logging.py:107:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 3 optimizer
[2025-08-18 12:59:32,849] [INFO] [utils.py:781:see_memory_usage] Stage 3 initialize beginning
[2025-08-18 12:59:32,850] [INFO] [utils.py:782:see_memory_usage] MA 3.94 GB         Max_MA 8.07 GB         CA 4.08 GB         Max_CA 8 GB 
[2025-08-18 12:59:32,850] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.52 GB, percent = 2.6%
[2025-08-18 12:59:32,862] [INFO] [stage3.py:170:__init__] Reduce bucket size 26214400
[2025-08-18 12:59:32,862] [INFO] [stage3.py:171:__init__] Prefetch bucket size 23592960
[2025-08-18 12:59:33,086] [INFO] [utils.py:781:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[2025-08-18 12:59:33,087] [INFO] [utils.py:782:see_memory_usage] MA 3.94 GB         Max_MA 3.94 GB         CA 4.08 GB         Max_CA 4 GB 
[2025-08-18 12:59:33,087] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.59 GB, percent = 2.6%
Parameter Offload: Total persistent parameters: 25760768 in 1025 params
[2025-08-18 12:59:34,626] [INFO] [utils.py:781:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[2025-08-18 12:59:34,627] [INFO] [utils.py:782:see_memory_usage] MA 3.82 GB         Max_MA 3.94 GB         CA 4.08 GB         Max_CA 4 GB 
[2025-08-18 12:59:34,627] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.87 GB, percent = 2.7%
[2025-08-18 12:59:34,925] [INFO] [utils.py:781:see_memory_usage] Before creating fp16 partitions
[2025-08-18 12:59:34,925] [INFO] [utils.py:782:see_memory_usage] MA 3.82 GB         Max_MA 3.82 GB         CA 4.08 GB         Max_CA 4 GB 
[2025-08-18 12:59:34,925] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.87 GB, percent = 2.7%
[2025-08-18 12:59:35,719] [INFO] [utils.py:781:see_memory_usage] After creating fp16 partitions: 1
[2025-08-18 12:59:35,720] [INFO] [utils.py:782:see_memory_usage] MA 3.82 GB         Max_MA 3.82 GB         CA 3.83 GB         Max_CA 4 GB 
[2025-08-18 12:59:35,720] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.93 GB, percent = 2.7%
[2025-08-18 12:59:36,031] [INFO] [utils.py:781:see_memory_usage] Before creating fp32 partitions
[2025-08-18 12:59:36,031] [INFO] [utils.py:782:see_memory_usage] MA 3.82 GB         Max_MA 3.82 GB         CA 3.83 GB         Max_CA 4 GB 
[2025-08-18 12:59:36,032] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.93 GB, percent = 2.7%
[2025-08-18 12:59:36,330] [INFO] [utils.py:781:see_memory_usage] After creating fp32 partitions
[2025-08-18 12:59:36,331] [INFO] [utils.py:782:see_memory_usage] MA 3.84 GB         Max_MA 3.85 GB         CA 3.85 GB         Max_CA 4 GB 
[2025-08-18 12:59:36,331] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.93 GB, percent = 2.7%
[2025-08-18 12:59:36,643] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-08-18 12:59:36,644] [INFO] [utils.py:782:see_memory_usage] MA 3.84 GB         Max_MA 3.84 GB         CA 3.85 GB         Max_CA 4 GB 
[2025-08-18 12:59:36,644] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.93 GB, percent = 2.7%
[2025-08-18 12:59:36,970] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-08-18 12:59:36,971] [INFO] [utils.py:782:see_memory_usage] MA 3.84 GB         Max_MA 3.85 GB         CA 3.87 GB         Max_CA 4 GB 
[2025-08-18 12:59:36,971] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 26.93 GB, percent = 2.7%
[2025-08-18 12:59:36,971] [INFO] [stage3.py:534:_setup_for_real_optimizer] optimizer state initialized
[2025-08-18 12:59:37,800] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-08-18 12:59:37,801] [INFO] [utils.py:782:see_memory_usage] MA 3.89 GB         Max_MA 3.9 GB         CA 3.91 GB         Max_CA 4 GB 
[2025-08-18 12:59:37,801] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 27.61 GB, percent = 2.7%
[2025-08-18 12:59:37,801] [INFO] [logging.py:107:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer_Stage3
[2025-08-18 12:59:37,801] [INFO] [logging.py:107:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-08-18 12:59:37,801] [INFO] [logging.py:107:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-08-18 12:59:37,801] [INFO] [logging.py:107:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0], mom=[(0.9, 0.999)]
[2025-08-18 12:59:37,814] [INFO] [config.py:1003:print] DeepSpeedEngine configuration:
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   amp_enabled .................. False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   amp_params ................... False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   bfloat16_enabled ............. True
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   bfloat16_immediate_grad_update  True
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   checkpoint_parallel_write_pipeline  False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   checkpoint_tag_validation_enabled  True
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   checkpoint_tag_validation_fail  False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f5514174410>
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   communication_data_type ...... None
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   compile_config ............... deepcompile=False free_activation=False offload_activation=False offload_opt_states=False double_buffer=True symmetric_memory=False debug_log=False offload_parameters=False sync_before_reduce=False sync_after_reduce=False sync_before_allgather=False sync_after_allgather=False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   curriculum_enabled_legacy .... False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   curriculum_params_legacy ..... False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'pin_memory': False, 'curriculum_learning': {'enabled': False}, 'dynamic_batching': {'enabled': False, 'lr_scaling_method': 'linear', 'min_batch_size': 1, 'max_batch_size': None, 'sequence_picking_order': 'dataloader', 'verbose': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   data_efficiency_enabled ...... False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   dataloader_drop_last ......... False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   disable_allgather ............ False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   dump_state ................... False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   dynamic_loss_scale_args ...... None
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   eigenvalue_enabled ........... False
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   eigenvalue_gas_boundary_resolution  1
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   eigenvalue_layer_num ......... 0
[2025-08-18 12:59:37,815] [INFO] [config.py:1007:print]   eigenvalue_max_iter .......... 100
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   eigenvalue_stability ......... 1e-06
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   eigenvalue_tol ............... 0.01
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   eigenvalue_verbose ........... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   elasticity_enabled ........... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   fp16_auto_cast ............... None
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   fp16_enabled ................. False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   fp16_master_weights_and_gradients  False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   global_rank .................. 0
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   grad_accum_dtype ............. None
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   gradient_accumulation_steps .. 8
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   gradient_clipping ............ 1.0
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   gradient_predivide_factor .... 1.0
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   graph_harvesting ............. False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   initial_dynamic_scale ........ 1
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   load_universal_checkpoint .... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   loss_scale ................... 1.0
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   memory_breakdown ............. False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   mics_hierarchial_params_gather  False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   mics_shard_size .............. -1
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   optimizer_legacy_fusion ...... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   optimizer_name ............... None
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   optimizer_params ............. None
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   pld_enabled .................. False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   pld_params ................... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   prescale_gradients ........... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   scheduler_name ............... None
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   scheduler_params ............. None
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   seq_parallel_communication_data_type  torch.float32
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   sparse_attention ............. None
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   sparse_gradients_enabled ..... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   steps_per_print .............. inf
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tp_overlap_comm=False tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   timers_config ................ enabled=True synchronized=True
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   train_batch_size ............. 128
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   train_micro_batch_size_per_gpu  1
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   use_data_before_expert_parallel_  False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   use_node_local_storage ....... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   wall_clock_breakdown ......... False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   weight_quantization_config ... None
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   world_size ................... 16
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   zero_allow_untested_optimizer  True
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=26214400 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=23592960 param_persistence_threshold=51200 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=True module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   zero_enabled ................. True
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   zero_force_ds_cpu_optimizer .. True
[2025-08-18 12:59:37,816] [INFO] [config.py:1007:print]   zero_optimization_stage ...... 3
[2025-08-18 12:59:37,816] [INFO] [config.py:993:print_user_config]   json = {
    "train_batch_size": 128, 
    "train_micro_batch_size_per_gpu": 1, 
    "gradient_accumulation_steps": 8, 
    "gradient_clipping": 1.0, 
    "zero_allow_untested_optimizer": true, 
    "fp16": {
        "enabled": false, 
        "loss_scale": 0, 
        "loss_scale_window": 1000, 
        "initial_scale_power": 16, 
        "hysteresis": 2, 
        "min_loss_scale": 1
    }, 
    "bf16": {
        "enabled": true
    }, 
    "zero_optimization": {
        "stage": 3, 
        "overlap_comm": false, 
        "contiguous_gradients": true, 
        "sub_group_size": 1.000000e+09, 
        "reduce_bucket_size": 2.621440e+07, 
        "stage3_prefetch_bucket_size": 2.359296e+07, 
        "stage3_param_persistence_threshold": 5.120000e+04, 
        "stage3_max_live_parameters": 1.000000e+09, 
        "stage3_max_reuse_distance": 1.000000e+09, 
        "stage3_gather_16bit_weights_on_model_save": true
    }, 
    "steps_per_print": inf
}
[INFO|trainer.py:2433] 2025-08-18 12:59:37,818 >> ***** Running training *****
[INFO|trainer.py:2434] 2025-08-18 12:59:37,818 >>   Num examples = 15
[INFO|trainer.py:2435] 2025-08-18 12:59:37,818 >>   Num Epochs = 3
[INFO|trainer.py:2436] 2025-08-18 12:59:37,818 >>   Instantaneous batch size per device = 1
[INFO|trainer.py:2439] 2025-08-18 12:59:37,818 >>   Total train batch size (w. parallel, distributed & accumulation) = 128
[INFO|trainer.py:2440] 2025-08-18 12:59:37,818 >>   Gradient Accumulation steps = 8
[INFO|trainer.py:2441] 2025-08-18 12:59:37,818 >>   Total optimization steps = 3
[INFO|trainer.py:2442] 2025-08-18 12:59:37,826 >>   Number of trainable parameters = 67,108,864
  0% 0/3 [00:00<?, ?it/s]907d14e27ed8:2064:3864 [0] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2066:3818 [2] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2067:3827 [3] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2070:3838 [6] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2069:3853 [5] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2064:3873 [0] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2064:3873 [0] NCCL INFO Using network Socket
907d14e27ed8:2071:3863 [7] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2068:3844 [4] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2065:3809 [1] NCCL INFO Comm config Blocking set to 1
907d14e27ed8:2067:3874 [3] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2066:3875 [2] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2067:3874 [3] NCCL INFO Using network Socket
907d14e27ed8:2066:3875 [2] NCCL INFO Using network Socket
907d14e27ed8:2068:3879 [4] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2068:3879 [4] NCCL INFO Using network Socket
907d14e27ed8:2069:3877 [5] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2069:3877 [5] NCCL INFO Using network Socket
907d14e27ed8:2071:3878 [7] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2071:3878 [7] NCCL INFO Using network Socket
907d14e27ed8:2065:3880 [1] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2065:3880 [1] NCCL INFO Using network Socket
907d14e27ed8:2070:3876 [6] NCCL INFO Using non-device net plugin version 0
907d14e27ed8:2070:3876 [6] NCCL INFO Using network Socket
907d14e27ed8:2069:3877 [5] NCCL INFO ncclCommInitRank comm 0x7fafa0edb4a0 rank 5 nranks 16 cudaDev 5 nvmlDev 5 busId b6000 commId 0xed0293622d5a8e7c - Init START
907d14e27ed8:2070:3876 [6] NCCL INFO ncclCommInitRank comm 0x7ff148edbec0 rank 6 nranks 16 cudaDev 6 nvmlDev 6 busId ce000 commId 0xed0293622d5a8e7c - Init START
907d14e27ed8:2068:3879 [4] NCCL INFO ncclCommInitRank comm 0x7f6a8cedb880 rank 4 nranks 16 cudaDev 4 nvmlDev 4 busId b5000 commId 0xed0293622d5a8e7c - Init START
907d14e27ed8:2071:3878 [7] NCCL INFO ncclCommInitRank comm 0x7fe05cedb520 rank 7 nranks 16 cudaDev 7 nvmlDev 7 busId cf000 commId 0xed0293622d5a8e7c - Init START
907d14e27ed8:2067:3874 [3] NCCL INFO ncclCommInitRank comm 0x7f92b0ede640 rank 3 nranks 16 cudaDev 3 nvmlDev 3 busId 20000 commId 0xed0293622d5a8e7c - Init START
907d14e27ed8:2066:3875 [2] NCCL INFO ncclCommInitRank comm 0x7f6abcedbcf0 rank 2 nranks 16 cudaDev 2 nvmlDev 2 busId 1f000 commId 0xed0293622d5a8e7c - Init START
907d14e27ed8:2065:3880 [1] NCCL INFO ncclCommInitRank comm 0x7f97b8edd580 rank 1 nranks 16 cudaDev 1 nvmlDev 1 busId f000 commId 0xed0293622d5a8e7c - Init START
907d14e27ed8:2064:3873 [0] NCCL INFO ncclCommInitRank comm 0x7f53e0edc6d0 rank 0 nranks 16 cudaDev 0 nvmlDev 0 busId e000 commId 0xed0293622d5a8e7c - Init START
907d14e27ed8:2064:3873 [0] NCCL INFO Setting affinity for GPU 0 to ffffffff
907d14e27ed8:2064:3873 [0] NCCL INFO NVLS multicast support is not available on dev 0
907d14e27ed8:2071:3878 [7] NCCL INFO Setting affinity for GPU 7 to ffffffff,00000000
907d14e27ed8:2071:3878 [7] NCCL INFO NVLS multicast support is not available on dev 7
907d14e27ed8:2065:3880 [1] NCCL INFO Setting affinity for GPU 1 to ffffffff
907d14e27ed8:2065:3880 [1] NCCL INFO NVLS multicast support is not available on dev 1
907d14e27ed8:2068:3879 [4] NCCL INFO Setting affinity for GPU 4 to ffffffff,00000000
907d14e27ed8:2068:3879 [4] NCCL INFO NVLS multicast support is not available on dev 4
907d14e27ed8:2069:3877 [5] NCCL INFO Setting affinity for GPU 5 to ffffffff,00000000
907d14e27ed8:2069:3877 [5] NCCL INFO NVLS multicast support is not available on dev 5
907d14e27ed8:2070:3876 [6] NCCL INFO Setting affinity for GPU 6 to ffffffff,00000000
907d14e27ed8:2070:3876 [6] NCCL INFO NVLS multicast support is not available on dev 6
907d14e27ed8:2067:3874 [3] NCCL INFO Setting affinity for GPU 3 to ffffffff
907d14e27ed8:2067:3874 [3] NCCL INFO NVLS multicast support is not available on dev 3
907d14e27ed8:2066:3875 [2] NCCL INFO Setting affinity for GPU 2 to ffffffff
907d14e27ed8:2066:3875 [2] NCCL INFO NVLS multicast support is not available on dev 2
907d14e27ed8:2070:3876 [6] NCCL INFO comm 0x7ff148edbec0 rank 6 nRanks 16 nNodes 2 localRanks 8 localRank 6 MNNVL 0
907d14e27ed8:2070:3876 [6] NCCL INFO Trees [0] 7/-1/-1->6->5 [1] 7/-1/-1->6->5
907d14e27ed8:2070:3876 [6] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2071:3878 [7] NCCL INFO comm 0x7fe05cedb520 rank 7 nRanks 16 nNodes 2 localRanks 8 localRank 7 MNNVL 0
907d14e27ed8:2069:3877 [5] NCCL INFO comm 0x7fafa0edb4a0 rank 5 nRanks 16 nNodes 2 localRanks 8 localRank 5 MNNVL 0
907d14e27ed8:2068:3879 [4] NCCL INFO comm 0x7f6a8cedb880 rank 4 nRanks 16 nNodes 2 localRanks 8 localRank 4 MNNVL 0
907d14e27ed8:2067:3874 [3] NCCL INFO comm 0x7f92b0ede640 rank 3 nRanks 16 nNodes 2 localRanks 8 localRank 3 MNNVL 0
907d14e27ed8:2069:3877 [5] NCCL INFO Trees [0] 6/-1/-1->5->4 [1] 6/-1/-1->5->4
907d14e27ed8:2068:3879 [4] NCCL INFO Trees [0] 5/-1/-1->4->3 [1] 5/-1/-1->4->3
907d14e27ed8:2069:3877 [5] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2071:3878 [7] NCCL INFO Trees [0] -1/-1/-1->7->6 [1] -1/-1/-1->7->6
907d14e27ed8:2068:3879 [4] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2071:3878 [7] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2067:3874 [3] NCCL INFO Trees [0] 4/-1/-1->3->2 [1] 4/-1/-1->3->2
907d14e27ed8:2067:3874 [3] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2066:3875 [2] NCCL INFO comm 0x7f6abcedbcf0 rank 2 nRanks 16 nNodes 2 localRanks 8 localRank 2 MNNVL 0
907d14e27ed8:2066:3875 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
907d14e27ed8:2066:3875 [2] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2065:3880 [1] NCCL INFO comm 0x7f97b8edd580 rank 1 nRanks 16 nNodes 2 localRanks 8 localRank 1 MNNVL 0
907d14e27ed8:2064:3873 [0] NCCL INFO comm 0x7f53e0edc6d0 rank 0 nRanks 16 nNodes 2 localRanks 8 localRank 0 MNNVL 0
907d14e27ed8:2065:3880 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
907d14e27ed8:2065:3880 [1] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 00/02 :    0   7   6   5   4   3   2   1   8  15  14  13  12  11  10   9
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 01/02 :    0   7   6   5   4   3   2   1   8  15  14  13  12  11  10   9
907d14e27ed8:2064:3873 [0] NCCL INFO Trees [0] 1/8/-1->0->-1 [1] 1/-1/-1->0->8
907d14e27ed8:2064:3873 [0] NCCL INFO P2P Chunksize set to 131072
907d14e27ed8:2070:3876 [6] NCCL INFO Channel 00/0 : 6[6] -> 5[5] via P2P/CUMEM/read
907d14e27ed8:2068:3879 [4] NCCL INFO Channel 00/0 : 4[4] -> 3[3] via P2P/CUMEM/read
907d14e27ed8:2067:3874 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/CUMEM/read
907d14e27ed8:2069:3877 [5] NCCL INFO Channel 00/0 : 5[5] -> 4[4] via P2P/CUMEM/read
907d14e27ed8:2066:3875 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/CUMEM/read
907d14e27ed8:2070:3876 [6] NCCL INFO Channel 01/0 : 6[6] -> 5[5] via P2P/CUMEM/read
907d14e27ed8:2068:3879 [4] NCCL INFO Channel 01/0 : 4[4] -> 3[3] via P2P/CUMEM/read
907d14e27ed8:2067:3874 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/CUMEM/read
907d14e27ed8:2069:3877 [5] NCCL INFO Channel 01/0 : 5[5] -> 4[4] via P2P/CUMEM/read
907d14e27ed8:2066:3875 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/CUMEM/read
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 00/0 : 9[1] -> 0[0] [receive] via NET/Socket/0
907d14e27ed8:2065:3880 [1] NCCL INFO Channel 00/0 : 1[1] -> 8[0] [send] via NET/Socket/0
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 01/0 : 9[1] -> 0[0] [receive] via NET/Socket/0
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 00/0 : 0[0] -> 7[7] via P2P/CUMEM/read
907d14e27ed8:2065:3880 [1] NCCL INFO Channel 01/0 : 1[1] -> 8[0] [send] via NET/Socket/0
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 01/0 : 0[0] -> 7[7] via P2P/CUMEM/read
907d14e27ed8:2071:3878 [7] NCCL INFO Channel 00/0 : 7[7] -> 6[6] via P2P/CUMEM/read
907d14e27ed8:2071:3878 [7] NCCL INFO Channel 01/0 : 7[7] -> 6[6] via P2P/CUMEM/read
907d14e27ed8:2067:3874 [3] NCCL INFO Connected all rings
907d14e27ed8:2068:3879 [4] NCCL INFO Connected all rings
907d14e27ed8:2067:3874 [3] NCCL INFO Channel 00/0 : 3[3] -> 4[4] via P2P/CUMEM/read
907d14e27ed8:2068:3879 [4] NCCL INFO Channel 00/0 : 4[4] -> 5[5] via P2P/CUMEM/read
907d14e27ed8:2069:3877 [5] NCCL INFO Connected all rings
907d14e27ed8:2071:3878 [7] NCCL INFO Connected all rings
907d14e27ed8:2070:3876 [6] NCCL INFO Connected all rings
907d14e27ed8:2067:3874 [3] NCCL INFO Channel 01/0 : 3[3] -> 4[4] via P2P/CUMEM/read
907d14e27ed8:2068:3879 [4] NCCL INFO Channel 01/0 : 4[4] -> 5[5] via P2P/CUMEM/read
907d14e27ed8:2069:3877 [5] NCCL INFO Channel 00/0 : 5[5] -> 6[6] via P2P/CUMEM/read
907d14e27ed8:2070:3876 [6] NCCL INFO Channel 00/0 : 6[6] -> 7[7] via P2P/CUMEM/read
907d14e27ed8:2069:3877 [5] NCCL INFO Channel 01/0 : 5[5] -> 6[6] via P2P/CUMEM/read
907d14e27ed8:2070:3876 [6] NCCL INFO Channel 01/0 : 6[6] -> 7[7] via P2P/CUMEM/read
907d14e27ed8:2064:3873 [0] NCCL INFO Connected all rings
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM/read
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM/read
907d14e27ed8:2065:3880 [1] NCCL INFO Connected all rings
907d14e27ed8:2066:3875 [2] NCCL INFO Connected all rings
907d14e27ed8:2065:3880 [1] NCCL INFO Channel 00/0 : 1[1] -> 2[2] via P2P/CUMEM/read
907d14e27ed8:2065:3880 [1] NCCL INFO Channel 01/0 : 1[1] -> 2[2] via P2P/CUMEM/read
907d14e27ed8:2066:3875 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/CUMEM/read
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 00/0 : 8[0] -> 0[0] [receive] via NET/Socket/0
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 01/0 : 8[0] -> 0[0] [receive] via NET/Socket/0
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 00/0 : 0[0] -> 8[0] [send] via NET/Socket/0
907d14e27ed8:2064:3873 [0] NCCL INFO Channel 01/0 : 0[0] -> 8[0] [send] via NET/Socket/0
907d14e27ed8:2066:3875 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/CUMEM/read
907d14e27ed8:2065:3880 [1] NCCL INFO Channel 00/0 : 1[1] -> 0[0] via P2P/CUMEM/read
907d14e27ed8:2065:3880 [1] NCCL INFO Channel 01/0 : 1[1] -> 0[0] via P2P/CUMEM/read
907d14e27ed8:2071:3878 [7] NCCL INFO Connected all trees
907d14e27ed8:2071:3878 [7] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2071:3878 [7] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2069:3877 [5] NCCL INFO Connected all trees
907d14e27ed8:2069:3877 [5] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2069:3877 [5] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2070:3876 [6] NCCL INFO Connected all trees
907d14e27ed8:2070:3876 [6] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2070:3876 [6] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2068:3879 [4] NCCL INFO Connected all trees
907d14e27ed8:2068:3879 [4] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2068:3879 [4] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2067:3874 [3] NCCL INFO Connected all trees
907d14e27ed8:2067:3874 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2067:3874 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2066:3875 [2] NCCL INFO Connected all trees
907d14e27ed8:2066:3875 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2066:3875 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2065:3880 [1] NCCL INFO Connected all trees
907d14e27ed8:2065:3880 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2065:3880 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2064:3873 [0] NCCL INFO Connected all trees
907d14e27ed8:2064:3873 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
907d14e27ed8:2064:3873 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 1 p2p channels per peer
907d14e27ed8:2067:3874 [3] NCCL INFO ncclCommInitRank comm 0x7f92b0ede640 rank 3 nranks 16 cudaDev 3 nvmlDev 3 busId 20000 commId 0xed0293622d5a8e7c - Init COMPLETE
907d14e27ed8:2066:3875 [2] NCCL INFO ncclCommInitRank comm 0x7f6abcedbcf0 rank 2 nranks 16 cudaDev 2 nvmlDev 2 busId 1f000 commId 0xed0293622d5a8e7c - Init COMPLETE
907d14e27ed8:2065:3880 [1] NCCL INFO ncclCommInitRank comm 0x7f97b8edd580 rank 1 nranks 16 cudaDev 1 nvmlDev 1 busId f000 commId 0xed0293622d5a8e7c - Init COMPLETE
907d14e27ed8:2071:3878 [7] NCCL INFO ncclCommInitRank comm 0x7fe05cedb520 rank 7 nranks 16 cudaDev 7 nvmlDev 7 busId cf000 commId 0xed0293622d5a8e7c - Init COMPLETE
907d14e27ed8:2064:3873 [0] NCCL INFO ncclCommInitRank comm 0x7f53e0edc6d0 rank 0 nranks 16 cudaDev 0 nvmlDev 0 busId e000 commId 0xed0293622d5a8e7c - Init COMPLETE
907d14e27ed8:2068:3879 [4] NCCL INFO ncclCommInitRank comm 0x7f6a8cedb880 rank 4 nranks 16 cudaDev 4 nvmlDev 4 busId b5000 commId 0xed0293622d5a8e7c - Init COMPLETE
907d14e27ed8:2070:3876 [6] NCCL INFO ncclCommInitRank comm 0x7ff148edbec0 rank 6 nranks 16 cudaDev 6 nvmlDev 6 busId ce000 commId 0xed0293622d5a8e7c - Init COMPLETE
907d14e27ed8:2069:3877 [5] NCCL INFO ncclCommInitRank comm 0x7fafa0edb4a0 rank 5 nranks 16 cudaDev 5 nvmlDev 5 busId b6000 commId 0xed0293622d5a8e7c - Init COMPLETE
 33% 1/3 [02:50<05:40, 170.45s/it] 67% 2/3 [04:39<02:14, 134.35s/it]100% 3/3 [06:28<00:00, 122.67s/it][INFO|trainer.py:4074] 2025-08-18 13:08:33,145 >> Saving model checkpoint to /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3
[INFO|configuration_utils.py:750] 2025-08-18 13:08:33,153 >> loading configuration file /data/Qwen2.5-32B-Instruct/config.json
[INFO|configuration_utils.py:817] 2025-08-18 13:08:33,154 >> Model config Qwen2Config {
  "architectures": [
    "Qwen2ForCausalLM"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 5120,
  "initializer_range": 0.02,
  "intermediate_size": 27648,
  "layer_types": [
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention"
  ],
  "max_position_embeddings": 32768,
  "max_window_layers": 70,
  "model_type": "qwen2",
  "num_attention_heads": 40,
  "num_hidden_layers": 64,
  "num_key_value_heads": 8,
  "rms_norm_eps": 1e-06,
  "rope_scaling": null,
  "rope_theta": 1000000.0,
  "sliding_window": null,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.55.0",
  "use_cache": true,
  "use_sliding_window": false,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2393] 2025-08-18 13:08:33,339 >> chat template saved in /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/chat_template.jinja
[INFO|tokenization_utils_base.py:2562] 2025-08-18 13:08:33,339 >> tokenizer config file saved in /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/tokenizer_config.json
[INFO|tokenization_utils_base.py:2571] 2025-08-18 13:08:33,339 >> Special tokens file saved in /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/special_tokens_map.json
[2025-08-18 13:08:35,281] [INFO] [logging.py:107:log_dist] [Rank 0] [Torch] Checkpoint global_step0 is about to be saved!
[2025-08-18 13:08:35,321] [INFO] [logging.py:107:log_dist] [Rank 0] Saving model checkpoint: /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/global_step0/zero_pp_rank_0_mp_rank_00_model_states.pt
[2025-08-18 13:08:35,321] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/global_step0/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2025-08-18 13:08:35,362] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/global_step0/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2025-08-18 13:08:35,371] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/global_step0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2025-08-18 13:08:35,402] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/global_step0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2025-08-18 13:08:35,403] [INFO] [engine.py:3701:_save_zero_checkpoint] zero checkpoint saved /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/checkpoint-3/global_step0/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2025-08-18 13:08:35,899] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step0 is ready now!
[INFO|trainer.py:2718] 2025-08-18 13:08:35,902 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                                  {'train_runtime': 538.0762, 'train_samples_per_second': 0.084, 'train_steps_per_second': 0.006, 'train_loss': 1.8948941230773926, 'epoch': 3.0}
100% 3/3 [08:58<00:00, 122.67s/it]100% 3/3 [08:58<00:00, 179.36s/it]
[INFO|trainer.py:4074] 2025-08-18 13:11:02,533 >> Saving model checkpoint to /data/llamafactory/saves/qwen2_5vl-32b/lora/sft
[INFO|configuration_utils.py:750] 2025-08-18 13:11:02,544 >> loading configuration file /data/Qwen2.5-32B-Instruct/config.json
[INFO|configuration_utils.py:817] 2025-08-18 13:11:02,545 >> Model config Qwen2Config {
  "architectures": [
    "Qwen2ForCausalLM"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 5120,
  "initializer_range": 0.02,
  "intermediate_size": 27648,
  "layer_types": [
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention",
    "full_attention"
  ],
  "max_position_embeddings": 32768,
  "max_window_layers": 70,
  "model_type": "qwen2",
  "num_attention_heads": 40,
  "num_hidden_layers": 64,
  "num_key_value_heads": 8,
  "rms_norm_eps": 1e-06,
  "rope_scaling": null,
  "rope_theta": 1000000.0,
  "sliding_window": null,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.55.0",
  "use_cache": true,
  "use_sliding_window": false,
  "vocab_size": 152064
}

[INFO|tokenization_utils_base.py:2393] 2025-08-18 13:11:02,761 >> chat template saved in /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/chat_template.jinja
[INFO|tokenization_utils_base.py:2562] 2025-08-18 13:11:02,762 >> tokenizer config file saved in /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/tokenizer_config.json
[INFO|tokenization_utils_base.py:2571] 2025-08-18 13:11:02,762 >> Special tokens file saved in /data/llamafactory/saves/qwen2_5vl-32b/lora/sft/special_tokens_map.json
***** train metrics *****
  epoch                    =        3.0
  total_flos               =     4716GF
  train_loss               =     1.8949
  train_runtime            = 0:08:58.07
  train_samples_per_second =      0.084
  train_steps_per_second   =      0.006
[WARNING|2025-08-18 13:11:02] llamafactory.extras.ploting:148 >> No metric loss to plot.
[WARNING|2025-08-18 13:11:02] llamafactory.extras.ploting:148 >> No metric eval_loss to plot.
[INFO|modelcard.py:456] 2025-08-18 13:11:02,905 >> Dropping the following result as it does not have all the necessary fields:
{'task': {'name': 'Causal Language Modeling', 'type': 'text-generation'}}
907d14e27ed8:2064:2064 [0] NCCL INFO comm 0x7f53e0edc6d0 rank 0 nranks 16 cudaDev 0 busId e000 - Destroy COMPLETE
907d14e27ed8:2064:2064 [0] NCCL INFO comm 0x55fae3cf5a80 rank 0 nranks 16 cudaDev 0 busId e000 - Destroy COMPLETE
907d14e27ed8:2070:2070 [6] NCCL INFO comm 0x7ff148edbec0 rank 6 nranks 16 cudaDev 6 busId ce000 - Destroy COMPLETE
907d14e27ed8:2071:2071 [7] NCCL INFO comm 0x7fe05cedb520 rank 7 nranks 16 cudaDev 7 busId cf000 - Destroy COMPLETE
907d14e27ed8:2069:2069 [5] NCCL INFO comm 0x7fafa0edb4a0 rank 5 nranks 16 cudaDev 5 busId b6000 - Destroy COMPLETE
907d14e27ed8:2067:2067 [3] NCCL INFO comm 0x7f92b0ede640 rank 3 nranks 16 cudaDev 3 busId 20000 - Destroy COMPLETE
907d14e27ed8:2068:2068 [4] NCCL INFO comm 0x7f6a8cedb880 rank 4 nranks 16 cudaDev 4 busId b5000 - Destroy COMPLETE
907d14e27ed8:2066:2066 [2] NCCL INFO comm 0x7f6abcedbcf0 rank 2 nranks 16 cudaDev 2 busId 1f000 - Destroy COMPLETE
907d14e27ed8:2065:2065 [1] NCCL INFO comm 0x7f97b8edd580 rank 1 nranks 16 cudaDev 1 busId f000 - Destroy COMPLETE
907d14e27ed8:2066:2066 [2] NCCL INFO comm 0x55939d27f1a0 rank 2 nranks 16 cudaDev 2 busId 1f000 - Destroy COMPLETE
907d14e27ed8:2071:2071 [7] NCCL INFO comm 0x561c2cb6dbd0 rank 7 nranks 16 cudaDev 7 busId cf000 - Destroy COMPLETE
907d14e27ed8:2067:2067 [3] NCCL INFO comm 0x55990cf98e90 rank 3 nranks 16 cudaDev 3 busId 20000 - Destroy COMPLETE
907d14e27ed8:2070:2070 [6] NCCL INFO comm 0x565256bf2850 rank 6 nranks 16 cudaDev 6 busId ce000 - Destroy COMPLETE
907d14e27ed8:2065:2065 [1] NCCL INFO comm 0x557a42936150 rank 1 nranks 16 cudaDev 1 busId f000 - Destroy COMPLETE
907d14e27ed8:2069:2069 [5] NCCL INFO comm 0x563699cb4fb0 rank 5 nranks 16 cudaDev 5 busId b6000 - Destroy COMPLETE
907d14e27ed8:2068:2068 [4] NCCL INFO comm 0x55a454968610 rank 4 nranks 16 cudaDev 4 busId b5000 - Destroy COMPLETE
